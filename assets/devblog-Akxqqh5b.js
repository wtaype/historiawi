import{h as i,s as f,b as h}from"./main-afWsqpZ7.js";import{db as d}from"./firebase-BJaYCV0a.js";import{u as C,i as A,d as b,g as k,b as I,c as S}from"./firebase-C6DIho6d.js";import"./main-ChwGR5oC.js";import"./vendor-gzd0YkcT.js";const m="blog",p={list:3,post:12,rel:6},c={list:(t,a)=>`wi_blog_${t}_${a}`,post:t=>`wi_post_${t}`,rel:t=>`wi_rel_${t}`},u=t=>t?.toDate?.()?.getTime?.()??t??null,_=t=>({...t,creado:u(t.creado),actualizado:u(t.actualizado)}),g={corta:{day:"numeric",month:"short",year:"numeric"},larga:{day:"numeric",month:"long",year:"numeric"}},U=(t,a)=>{if(!t)return"";try{return new Date(t).toLocaleDateString("es-PE",a?g.larga:g.corta)}catch{return""}},v=[{id:"todo",icon:"fa-paw",label:"Todas",color:"var(--mco)"},{id:"Animales",icon:"fa-dog",label:"Animales",color:"#0EBEFF"},{id:"Naturaleza",icon:"fa-leaf",label:"Naturaleza",color:"#25b62a"},{id:"Amor",icon:"fa-heart",label:"Amor",color:"#ff3849"},{id:"Inspiración",icon:"fa-star",label:"Inspiración",color:"#ffa726"},{id:"Vida",icon:"fa-seedling",label:"Vida",color:"#6a00f5"}],E=t=>v.find(a=>a.id===t)||v[1],L=()=>'<div class="bl_card_sk"><div class="bl_sk_img shimmer"></div><div class="bl_sk_body"><div class="bl_sk_cat shimmer"></div><div class="bl_sk_tit shimmer"></div><div class="bl_sk_tit bl_sk_t2 shimmer"></div><div class="bl_sk_p shimmer"></div><div class="bl_sk_p bl_sk_p2 shimmer"></div><div class="bl_sk_foot shimmer"></div></div></div>',j=(t="bl_fade",a=document)=>requestAnimationFrame(()=>a.querySelectorAll?.(`.${t}:not(.${t.replace("fade","visible")})`)?.forEach(e=>{const s=parseFloat(e.style.getPropertyValue("--d")||"0")*1e3;setTimeout(()=>e.classList.add(t.replace("fade","visible")),s)})),T=t=>[{icon:"fab fa-facebook",url:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(location.href)}`,color:"#1877F2",label:"Facebook"},{icon:"fab fa-twitter",url:`https://twitter.com/intent/tweet?url=${encodeURIComponent(location.href)}&text=${encodeURIComponent(t)}`,color:"#1da1f2",label:"Twitter"},{icon:"fab fa-whatsapp",url:`https://wa.me/?text=${encodeURIComponent(t+" "+location.href)}`,color:"#25D366",label:"WhatsApp"},{icon:"fab fa-telegram",url:`https://t.me/share/url?url=${encodeURIComponent(location.href)}&text=${encodeURIComponent(t)}`,color:"#0088cc",label:"Telegram"}],z=(t,a)=>T(t).map((e,s)=>a||s<3?`
  <a href="${e.url}" target="_blank" rel="noopener" class="po_share_${a?"full_":""}btn" style="--sc:${e.color}" ${h(e.label)}>
    <i class="${e.icon}"></i>${a?` ${e.label}`:""}
  </a>`:"").join(""),O=t=>t?`<span class="bl_cache_tag" ${h("⚡ Cache local")}><i class="fas fa-bolt"></i> Cache</span>`:`<span class="bl_fire_tag"  ${h("☁️ Firestore")}><i class="fas fa-database"></i> Firestore</span>`;let n=null,w=0;const $=async t=>(!t&&n&&Date.now()-w<6e4||(n=(await I(S(d,m))).docs.map(e=>_(e.data())).filter(e=>e.activo),w=Date.now()),n),V=async(t="todo",a="nuevo",e=!1)=>{const s=c.list(t,a);if(!e){const o=i(s);if(Array.isArray(o)&&o.length)return{lista:o,fromCache:!0}}let r=await $(e);return t!=="todo"&&(r=r.filter(o=>o.categoria===t)),r=[...r].sort((o,l)=>a==="vistas"?(l.vistas||0)-(o.vistas||0):(l.creado||0)-(o.creado||0)),r.length&&f(s,r,p.list),{lista:r,fromCache:!1}},W=async(t,a=!1)=>{if(!a){const r=i(c.post(t));if(r)return{data:r,fromCache:!0}}const e=await k(b(d,m,t));if(!e.exists())return null;const s=_(e.data());return f(c.post(t),s,p.post),{data:s,fromCache:!1}},B=t=>{for(const a of Object.keys(localStorage).filter(e=>e.startsWith("wi_blog_"))){const e=i(a);if(Array.isArray(e)){const s=e.find(r=>r.slug===t||r.id===t);if(s)return s}}return null},q=async(t,a,e=!1)=>{if(!e){const o=i(c.rel(a));if(Array.isArray(o))return o.filter(l=>l.slug!==t&&l.id!==t).slice(0,3)}let s=n||[];if(!s.length)for(const o of Object.keys(localStorage).filter(l=>l.startsWith("wi_blog_"))){const l=i(o);if(Array.isArray(l)&&l.length){s=l;break}}s.length||(s=await $(e));const r=s.filter(o=>o.activo!==!1&&o.categoria===a).sort((o,l)=>(l.creado||0)-(o.creado||0)).slice(0,5);return r.length&&f(c.rel(a),r,p.rel),r.filter(o=>o.slug!==t&&o.id!==t).slice(0,3)},y=new Set,M=t=>{y.has(t)||i(c.post(t))||(y.add(t),k(b(d,m,t)).then(a=>a.exists()&&f(c.post(t),_(a.data()),p.post)).catch(()=>{}))},N=t=>C(b(d,m,t),{vistas:A(1)}).catch(()=>{}),K=t=>localStorage.removeItem(c.post(t)),G=t=>localStorage.removeItem(c.rel(t)),H=()=>Object.keys(localStorage).filter(t=>t.startsWith("wi_blog_")).forEach(t=>localStorage.removeItem(t));export{v as CATS,m as COL,N as addView,E as catInfo,H as clearBlogCache,K as clearPostCache,G as clearRelCache,j as fade,W as getPost,V as getPosts,B as getPreview,q as getRelacionados,M as prefetchPost,_ as ser,T as shareLinks,L as skCard,O as srcBadge,U as superDate,z as tplShare};
